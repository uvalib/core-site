#
# deployspec.yml
#

version: 0.2

#env:
#  variables:
#    name: value

phases:
  install:
    runtime-versions:
      nodejs: 10
#    commands:

  pre_build:
    commands:
      - TODAYS_DATE=$(date +"%Y%m%d")

  build:
    commands:
      - LATEST_ASSETS_FILE=$(aws s3 ls s3://$BUCKET_NAME/$TODAYS_DATE | grep es6-assets | head -1 | awk '{print $4}')
      - aws s3 cp s3://$BUCKET_NAME/$LATEST_ASSETS_FILE .
      - mkdir $CODEBUILD_SRC_DIR/es6-assets
      - cd $CODEBUILD_SRC_DIR/es6-assets
      - tar xzvf $CODEBUILD_SRC_DIR/$LATEST_ASSETS_FILE .
      # do the rsync
      #- rsync -av $CODEBUILD_SRC_DIR/es6-assets/ <target host>:/wwwstatic

#  post_build:
#    commands:

#
# end of file
#
